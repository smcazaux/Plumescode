x = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,51.1256628793112,51.2513207976671,51.3769687943082,51.5026019088668,51.6282151815626,51.7538036533987,51.8793623663573,52.0048863635954,52.1303706896405,52.2558103905863,52.3812005142881,52.5065361105587,52.6318122313632,52.7570239310149,52.8821662663703,53.0072342970243,53.1322230855052,53.2571276974696,53.3819432018974,53.5066646712861,53.6312871818457,53.7558058136928,53.8802156510450,54.0045117824151,54.1286893008046,54.2527433038977,54.3766688942547,54.5004611795055,54.6241152725427,54.7476262917145,54.8709893610172,54.9941996102881,55.1172521753976,55.2401421984411,55.3628648279309,55.4854152189876,55.6077885335318,55.7299799404745,55.8519846159082,55.9737977432971,56.0954145136676,56.2168301257979,56.3380397864075,56.4590387103465,56.5798221207846,56.7003852493995,56.8207233365654,56.9408316315407,57.0607053926555,57.1803398874989,57.2997303931061,57.4188721961442,57.5377605930989,57.6563908904597,57.7747584049058,57.8928584634903,58.0106864038252,58.1282375742650,58.2455073340909,58.3624910536936,58.4791841147560,58.5955819104360,58.7116798455479,58.8274733367441,58.9429578126956,59.0581287142733,59.1729814947270,59.2875116198657,59.4017145682361,59.5155858313015,59.6291209136192,59.7423153330187,59.8551646207780,59.9676643218006,60.0798099947909,60.1915972124298,60.3030215615492,60.4140786433067,60.5247640733588,60.6350734820343,60.7450025145066,60.8545468309658,60.9637021067898,61.0724640327152,61.1808283150074,61.2887906756301,61.3963468524142,61.5034925992259,61.6102236861347,61.7165358995799,61.8224250425375,61.9278869346854,62.0329174125686,62.1375123297638,62.2416675570426,62.3453789825351,62.4486425118918,62.5514540684454,62.6538095933715,62.7557050458495,62.8571364032212,62.9580996611504,63.0585908337805,63.1586059538921,63.2581410730595,63.3571922618067,63.4557556097623,63.5538272258140,63.6514032382625,63.7484797949738,63.8450530635317,63.9411192313889,64.0366745060176,64.1317151150591,64.2262373064730,64.3202373486850,64.4137115307344,64.5066561624205,64.5990675744484,64.6909421185738,64.7822761677470,64.8730661162561,64.9633083798695,65.0529993959770,65.1421356237310,65.2307135441857,65.3187296604366,65.4061804977581,65.4930626037409,65.5793725484282,65.6651069244512,65.7502623471635,65.8348354547748,65.9188229084837,66.0022213926092,66.0850276147221,66.1672383057744,66.2488502202290,66.3298601361870,66.4102648555158,66.4900612039747,66.5692460313405,66.6478162115318,66.7257686427324,66.8031002475138,66.8798079729567,66.9558887907714,67.0313396974175,67.1061577142224,67.1803398874990,67.2538832886619,67.3267850143437,67.3990421865091,67.4706519525686,67.5416114854913,67.6119179839163,67.6815686722634,67.7505608008428,67.8188916459634,67.8865585100403,67.9535587217017,68.0198896358938,68.0855486339859,68.1505331238731,68.2148405400789,68.2784683438567,68.3414140232898,68.4036750933905,68.4652490961984,68.5261336008773,68.5863262038111,68.6458245286991,68.7046262266491,68.7627289762709,68.8201304837674,68.8768284830253,68.9328207357047,68.9881050313274,69.0426791873641,69.0965410493204,69.1496884908223,69.2021194136999,69.2538317480701,69.3048234524184,69.3550925136796,69.4046369473174,69.4534547974023,69.5015441366892,69.5489030666932,69.5955297177650,69.6414222491642,69.6865788491323,69.7309977349639,69.7746771530775,69.8176153790845,69.8598107178573,69.9012615035961,69.9419660998949,69.9819228998059,70.0211303259031,70.0595868303444,70.0972908949329,70.1342410311766,70.1704357803475,70.2059263541990,70.2235969179477,70.2416459799016,70.2600728275146,70.2788767333265,70.2980569549911,70.3176127353063,70.3375433022432,70.3578478689771,70.3785256339187,70.3995757807451,70.4209974784325,70.4427898812891,70.4649521289880,70.4874833466017,70.5103826446363,70.5336491190667,70.5572818513724,70.5812799085734,70.6056423432677,70.6303681936681,70.6554564836402,70.6809062227413,70.7067164062594,70.7328860152526,70.7594140165895,70.7862993629901,70.8135409930668,70.8411378313669,70.8690887884144,70.8973927607533,70.9260486309913,70.9550552678437,70.9844115261782,71.0141162470599,71.0441682577973,71.0745663719885,71.1053093895680,71.1363960968540,71.1678252665968,71.1995956580263,71.2317060169020,71.2641550755619,71.2969415529727,71.3300641547804,71.3635215733614,71.3973124878741,71.4314355643111,71.4658894555517,71.5006728014153,71.5357842287150,71.5712223513118,71.6069857701691,71.6430730734086,71.6794828363652,71.7162136216439,71.7532639791762,71.7906324462773,71.8283175477042,71.8663177957136,71.9046316901208,71.9432577183588,71.9821943555382,72.0214400645072,72.0609932959125,72.1008524882601,72.1410160679774,72.1814824494750,72.2222500352096,72.2633172157465,72.3046823698239,72.3463438644163,72.3883000547993,72.4305492846142,72.4730898859338,72.5159201793280,72.5590384739302,72.6024430675039,72.6461322465102,72.6901042861749,72.7343574505573,72.7788899926183,72.8237001542893,72.8687861665418,72.9141462494574,72.9597786122975,73.0056814535747,73.0518529611233,73.0982913121714,73.1449946734123,73.1919612010773,73.2391890410083,73.2866763287310,73.3344211895287,73.3824217385159,73.4306760807133,73.4791823111219,73.5279385147990,73.5769427669329,73.6261931329199,73.6756876684397,73.7254244195328,73.7754014226775,73.8256167048673,73.8760682836888,73.9267541674000,73.9776723550091,74.0288208363532,74.0801975921778,74.1318005942166,74.1836278052715,74.2356771792928,74.2879466614604,74.3404341882647,74.3931376875879,74.4460550787862,74.4991842727715,74.5525231720943,74.6060696710262,74.6598216556430,74.7137770039084,74.7679335857577,74.8222892631817,74.8768418903115,74.9315893135025,74.9865293714205,75.0416598951258,75.0969787081600,75.1524836266308,75.2081724592992,75.2640430076655,75.3200930660560,75.3763204217105,75.4327228548691,75.4892981388604,75.5460440401891,75.6029583186242,75.6600387272873,75.7172830127417,75.7746889150811,75.8322541680186,75.8899764989767,75.9478536291766,76.0058832737283,76.0640631417208,76.1223909363124,76.1808643548218,76.2394810888186,76.2982388242143,76.3571352413543,76.4161680151088,76.4753348149651,76.5346333051190,76.5940611445680,76.6536159872024,76.7132954818992,76.7730972726141,76.8330189984748,76.8930582938741,76.9532127885635,77.0134801077465,77.0738578721726,77.1343436982309,77.1949351980447,77.2556299795653,77.3164256466667,77.3773197992399,77.4383100332882,77.4993939410215,77.5605691109517,77.6218331279879,77.6831835735316,77.7446180255722,77.8061340587828,77.8677292446157,77.9294011513985,77.9911473444298,78.0529653860756,78.1148528358657,78.1768072505893,78.2388261843923,78.3009071888734,78.3630478131808,78.4252456041091,78.4874981061960,78.5498028618192,78.6121574112939,78.6745592929689,78.7370060433251,78.7994951970715,78.8620242872433,78.9245908452993,78.9871924012187,79.0498264835993,79.1124906197549,79.1751823358126,79.2378991568108,79.3006386067968,79.3633982089246,79.4261754855525,79.4889679583411,79.5517731483512,79.6145885761413,79.6774117618660,79.7402402253734,79.8030714863033,81.8031000000000,83.8031000000000,85.8031000000000,87.8031000000000,89.8031000000000,91.8031000000000,93.8031000000000,95.8031000000000,97.8031000000000,99.8031000000000,101.803100000000,103.803100000000,105.803100000000,107.803100000000,109.803100000000,111.803100000000,113.803100000000,115.803100000000,117.803100000000,119.803100000000,121.803100000000,123.803100000000,125.803100000000,127.803100000000,129.803100000000,131.803100000000,133.803100000000,135.803100000000,137.803100000000,139.803100000000,141.803100000000,143.803100000000,145.803100000000,147.803100000000,149.803100000000,151.803100000000,153.803100000000,155.803100000000,157.803100000000,159.803100000000,161.803100000000,163.803100000000,165.803100000000,167.803100000000,169.803100000000,171.803100000000,173.803100000000,175.803100000000,177.803100000000,179.803100000000,181.803100000000,183.803100000000,185.803100000000,187.803100000000,189.803100000000,191.803100000000,193.803100000000,195.803100000000,197.803100000000,199.803100000000];
x = linspace(0,150,300);
l = 1;
          
for i = 1:length(l)
    results{i} = xlsread(['C:\Users\nicky\Documents\Thesis\CFD_Plumes - Wall Interactions\Figures\Walls_Nuc_V0fix_ChannelNr39_rho0.0044943_T266.3314_pe0_Cx0.3_i160000_n300_C0.002_b0.2_L150_De20_c_stick0.2\runData.xlsx']);
    fullResults{i} = xlsread(['C:\Users\nicky\Documents\Thesis\CFD_Plumes - Wall Interactions\Figures\Walls_Nuc_V0fix_ChannelNr39_rho0.0044943_T266.3314_pe0_Cx0.3_i160000_n300_C0.002_b0.2_L150_De20_c_stick0.2\runFullData.xlsx']);
    constants{i} = xlsread(['C:\Users\nicky\Documents\Thesis\CFD_Plumes - Wall Interactions\Figures\Walls_Nuc_V0fix_ChannelNr39_rho0.0044943_T266.3314_pe0_Cx0.3_i160000_n300_C0.002_b0.2_L150_De20_c_stick0.2\constantsData.xlsx']);

    if length(l) > 1
        T{i} = fullResults{i}(1:length(x),1);
        rho{i} = fullResults{i}(1:length(x),2);
        p{i} = fullResults{i}(1:length(x),3);
        V{i} = fullResults{i}(1:length(x),4);
        M{i} = fullResults{i}(1:length(x),5);
        f{i} = fullResults{i}(1:length(x),6);
        R{i} = fullResults{i}(1:length(x),7);
        S{i} = fullResults{i}(1:length(x),8);
        gn{i} = fullResults{i}(1:length(x),9);
        fp{i} = fullResults{i}(1:length(x),10);
        dRdx{i} = fullResults{i}(1:length(x),11);
        E_dotL{i} = fullResults{i}(1:length(x),12);
        E{i} = fullResults{i}(1:length(x),13);
        A_d{i} = fullResults{i}(1:length(x),14);
        x_d{i} = fullResults{i}(1:length(x),15);
    else
        T = fullResults{i}(1:length(x),1);
        rho = fullResults{i}(1:length(x),2);
        p = fullResults{i}(1:length(x),3);
        V = fullResults{i}(1:length(x),4);
        M = fullResults{i}(1:length(x),5);
        f = fullResults{i}(1:length(x),6);
        R = fullResults{i}(1:length(x),7);
        S = fullResults{i}(1:length(x),8);
        gn = fullResults{i}(1:length(x),9);
        fp = fullResults{i}(1:length(x),10);
        dRdx = fullResults{i}(1:length(x),11);
        E_dotL = fullResults{i}(1:length(x),12);
        E = fullResults{i}(1:length(x),13);
        A_d = fullResults{i}(1:length(x),14);
        x_d = fullResults{i}(1:length(x),15);
    end
    T = transpose(T); rho = transpose(rho); p = transpose(p); V = transpose(V); M = transpose(M);
    f = transpose(f); R = transpose(R); S = transpose(S); gn = transpose(gn); fp = transpose(fp);
    dRdx = transpose(dRdx); E_dotL = transpose(E_dotL);
end
%% figures for 1 cell
figure(1)
subplot(7,1,1)
plot(x_d, T,'g-')
hold on
grid on
ylabel('T [K]')
xlabel('x [m]')
subplot(7,1,2)
plot(x_d, rho,'b-')
hold on
grid on
ylabel('\rho [kg/m^3]')
xlabel('x [m]')
subplot(7,1,3)
plot(x_d, dRdx,'g-')
hold on
grid on
ylabel('dRdx')
xlabel('x [m]')
subplot(7,1,4)
plot(x_d, R,'r-')
hold on
grid on
ylabel('R [m]')
xlabel('x [m]')
subplot(7,1,5)
plot(x_d, gn,'k-')
hold on
grid on
ylabel('y_{nuc} [1/(m^3s)]')
xlabel('x [m]')
subplot(7,1,6)
plot(x_d, fp,'g-')
hold on
grid on
ylabel('df/dx')
xlabel('x [m]')
subplot(7,1,7)
plot(x_d, f,'y-')
hold on
grid on
ylabel('f')
xlabel('x [m]')
%%
for i = 1:length(l)
    dudx = gradient(V{i}(:)) ./ gradient(x_d{i}(:)); 
    dgndx= gradient(gn{i}(:)) ./ gradient(x_d{i}(:));
    dAdx = gradient(A(:)) ./ gradient(x_d{i}(:)); 
    figure(i+9)
    subplot(3,1,1)
    plot(x_d{i}, dAdx, '-g')
    ylabel('dA/dx')
    xlabel('z [m]')
    hold on
    grid on
    subplot(3,1,2)
    plot(x_d{i},dudx,'r-')
    ylabel('du/dx')
    xlabel('x [m]')
    hold on
    grid on
    subplot(3,1,3)
    plot(x_d{i}, dgndx, '-b')
    ylabel('dy_{nuc}/dx')
    xlabel('x [m]') 
    hold on
    grid on
end
%% figures for multiple cells
for i = 1:length(l)
    figure(i+6)
    subplot(7,1,1)
    plot(x_d{i}, T{i},'g-')
    hold on
    grid on
    ylabel('T [K]')
    xlabel('x [m]')
    subplot(7,1,2)
    plot(x_d{i}, rho{i},'b-')
    hold on
    grid on
    ylabel('\rho [kg/m^3]')
    xlabel('x [m]')
    subplot(7,1,3)
    plot(x_d{i}, dRdx{i},'g-')
    hold on
    grid on
    ylabel('dRdx')
    xlabel('x [m]')
    subplot(7,1,4)
    plot(x_d{i}, R{i},'r-')
    hold on
    grid on
    ylabel('R [m]')
    xlabel('x [m]')
    subplot(7,1,5)
    plot(x_d{i}, gn{i},'k-')
    hold on
    grid on
    ylabel('y_{nuc} [1/(m^3s)]')
    xlabel('x [m]')
    subplot(7,1,6)
    plot(x_d{i}, fp{i},'g-')
    hold on
    grid on
    ylabel('df/dx')
    xlabel('x [m]')
    subplot(7,1,7)
    plot(x_d{i}, f{i},'y-')
    hold on
    grid on
    ylabel('f')
    xlabel('x [m]')
    
end
    
%% figures %%
figure(1)
plot(x,fullResults{1}(:,1))
hold on
plot(x,fullResults{2}(:,1))
plot(x,fullResults{3}(:,1))
ylabel('T[K]')
xlabel('x')
%%
figure(1)
subplot(3,1,1)
m1 = rho.*A.*V;
plot(x_d,m1)
ylabel('\dot{m}_{flow} [kg/s]')
xlabel('x [m]')
subplot(3,1,2)
m2 = rho.*A.*M.*sqrt(4/3*461.4472.*T_d)
plot(x_d,m2)
ylabel('\dot{m}_{flow} [kg/s]')
xlabel('x [m]')
subplot(3,1,3)
m3 = rho./0.0065.*A./(2.2874e-5).*V./3.5793
plot(x,m3)
ylabel('\dot{m}_{flow} [-]')
xlabel('x [-]')
figure(2)
subplot(3,2,1)
plot(x_d,rho)
ylabel('\rho [kg/m^3]')
subplot(3,2,2)
plot(x,rho./0.0065)
ylabel('\rho [-]')
subplot(3,2,3)
plot(x_d,A)
ylabel('A [m^2]')
subplot(3,2,4)
plot(x,A./2.2874e-5)
ylabel('A [-]')
subplot(3,2,5)
plot(x_d,V)
ylabel('V [m/s]')
subplot(3,2,6)
plot(x_d,V./sqrt(4/3.*461.4472.*278.6565))
ylabel('V [-]')
